@model ArabicTextAnalyzer.Domain.Models.M_ARABIZIENTRY
@{
    ViewBag.Title = "Train";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles {
    @Styles.Render("~/Content/css_train")

    @Styles.Render("~/Content/js_train_tagsinput")

    <link href="https://cdn.datatables.net/select/1.2.3/css/select.dataTables.min.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.4.2/css/buttons.dataTables.min.css"/>

    @* vertical load time *@
    <link rel="stylesheet" type="text/css" href="~/Content/hlpr.vertical-text.css"/>
}

@section scripts {

    <!--<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/united/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/dataTables.bootstrap.min.css">-->
    <!--<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>-->
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.13/js/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/mark.js/8.6.0/jquery.mark.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/datatables.mark.js/2.0.0/datatables.mark.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/select/1.2.3/js/dataTables.select.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.2/js/buttons.html5.min.js"></script>

    @Scripts.Render("~/bundles/js_train")
    @Scripts.Render("~/bundles/js_train_keywordfiltering");
    @Scripts.Render("~/bundles/js_train_tagsinput");

    @* vertical load time *@
    <script type="text/javascript" src="~/Scripts/my.js"></script>
}

<h2>Training (v0.1710.18.11)</h2>

<!-- theme menu -->
<div class="dropdown div-inline">
    <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
        Select Theme
        <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
        @foreach (var xtrctTheme in ViewBag.XtrctThemes)
        {
            <li class="@xtrctTheme.CurrentActive"><a href="@Url.Action("XtrctTheme_ApplyNewActive", new { themename = @xtrctTheme.ThemeName })">@xtrctTheme.ThemeName</a></li>
        }
    </ul>
</div>
<button type="button" class="btn btn-sm" data-toggle="modal" data-target="#myModal">
    <span class="glyphicon glyphicon-plus"></span>
</button>
<button type="button" class="btn btn-sm" data-toggle="modal" data-target="#myModal">
    <span class="glyphicon glyphicon-edit"></span>
</button>
<button type="button" class="btn btn-sm">
    <span class="glyphicon glyphicon-remove"></span>
</button>

<!-- modal new theme dialogbox -->
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 style="color:red;">New Theme to Analyze</h4>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("XtrctTheme_AddNew", "Train", FormMethod.Post))
                {
                    <div class="form-group">
                        <label for="themename">Theme Name</label>
                        @Html.TextBox("themename", "", new { @class = "form-control", placeholder = "Enter new theme name", @required = "required", id = "themename" })
                    </div>
                    <div class="form-group">
                        <label for="themetags">Theme Tags</label>
                        @Html.TextBox("themetags", "", new { @class = "form-control", @required = "required", id = "themetags", data_role = "tagsinput" })
                    </div>
                    <button type="submit" class="btn btn-default btn-success">Add</button>
                }
            </div>
        </div>
    </div>
</div>

<!-- Theme & keywords -->
<h3><span class="label label-info">@ViewBag.ActiveXtrctTheme.ThemeName</span></h3>
@foreach (var tag in ViewBag.ActiveXtrctThemeTags)
{
    if (ViewBag.ActiveXtrctThemeTags.IndexOf(tag) % 2 == 0)
    {
        <span class="label label-primary themekeywords">@tag.Keyword</span>
    }
    else
    {
        <span class="label label-success themekeywords">@tag.Keyword</span>
    }
}
<a href="@Url.Action("XtrctTheme_Keywords_Reload", new { themename = @ViewBag.ActiveXtrctTheme.ThemeName })" class="btn btn-danger btn-xs">
    <span class="glyphicon glyphicon-refresh" aria-hidden="true">
</span></a>

<!-- arabizi keying & corpus info & co -->
<div id="row-arabizi-input" class="row" style="margin-top: 30px">
    <!-- column 1 : arabizi input -->
    <div class="col-md-3 col-sm-6">
        @using (Html.BeginForm("TrainStepOne", "Train", FormMethod.Post))
            {
            <div class="panel panel-default active">
                <div class="panel-heading">Arabizi</div>
                <div class="panel-body" style="padding: 0; height: 150px">
                    @Html.TextAreaFor(m => m.ArabiziText, new { id = "SentenceIn", style = "height: 100%; width: 100%", @required = "required" })
                    @Html.HiddenFor(m => m.ArabiziEntryDate, new { @Value = System.DateTime.Now })
                </div>
            </div>
            <!-- button submit -->
            <div class="row">
                <div class="col-md-2">
                    <button class="btn btn-success btn-md" type="submit" id="train">
                        Train
                    </button>
                </div>
            </div>
        }
    </div>
    <!-- column 2 : Twingly/Corpus Res -->
    <div class="col-md-2 col-sm-6">
        @if (String.IsNullOrEmpty(ViewBag.MostPopularVariant) == false)
            {
            <div class="panel panel-default active arabic ">
                <div class="panel-heading">Most Popular Variant : @ViewBag.MostPopularVariant</div>
                <div class="panel-body" style="padding: 0; height: 150px; position:relative;">
                    <div class="loader"></div>
                    <textarea style="height: 100%; width: 100%" id="arabic-text">@ViewBag.Post</textarea>
                </div>
            </div>
        }
    </div>
    <!-- column 3 : corpus info -->
    <div class="col-md-3 col-sm-6">
        <div class="panel panel-default active arabic ">
            <div class="panel-heading">Corpus/Bidict Info</div>
            <div class="panel-body" style="height: 150px; position:relative;">
                <div class="row">
                    <div class="col-md-6 col-xs-6"><small>Corpus Lines:</small></div>
                    <div class="col-md-6 col-xs-6"><small>@String.Format("{0:n0}", @ViewBag.CorpusSize)</small></div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-xs-6"><small>Bidict Lines:</small></div>
                    <div class="col-md-6 col-xs-6"><small>@String.Format("{0:n0}", @ViewBag.BidictSize)</small></div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-xs-6"><small>Arabizi Entries:</small></div>
                    <div class="col-md-6 col-xs-6"><small>@String.Format("{0:n0}", @ViewBag.ArabiziEntriesCount)</small></div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-xs-6"><small>Entities Count:</small></div>
                    <div class="col-md-6 col-xs-6"><small>@String.Format("{0:n0}", @ViewBag.EntitiesCount)</small></div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-xs-6"><small>Ratio Latin:</small></div>
                    <div class="col-md-6 col-xs-6"><small>@String.Format("{0:n2}", @ViewBag.RatioLatinWordsOnEntries)</small></div>
                </div>
            </div>
        </div>
    </div>
    <!-- column 4 : twingly accounts -->
    <div class="col-md-4 col-sm-6">
        <div class="panel panel-default active arabic ">
            <div class="panel-heading row" style="margin-left: 0px; margin-right: 0px;">
                <div class="col-xs-6 col-lg-2">Twingly</div>
                <div class="col-xs-6 col-lg-10"><input type="text" name="txtNewTwinglyAccount" class="form-control" value="" placeholder="" id="txtNewTwinglyAccount" style="padding: 0; border: 0; height: 20px;"></div>
            </div>
            <div class="panel-body" style="height: 150px; position: relative;">
                <div class="form-group">
                    <div id="myButtons" class="btn-group-vertical btn-group-sm" data-toggle="buttons">
                        @foreach (var twinglyAccount in @ViewBag.TwinglyAccounts)
                        {
                            <label class="btn btn-primary @twinglyAccount.CurrentActive" data-toggle='tooltip' title='@twinglyAccount.UserName'>
                                @Html.RadioButton("name", "value", true, new { id = "id" }) @twinglyAccount.ID_TWINGLYACCOUNT_API_KEY.ToString().ToUpper()
                                <span class='badge'>@twinglyAccount.calls_free</span>
                            </label>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@{
    bool showAlertWarning = ViewBag.showAlertWarning;
    bool showAlertSuccess = ViewBag.showAlertSuccess;
    String msgAlert = ViewBag.msgAlert;
}

<!-- upload large file of posts -->
<div id="row-bulk-input" class="row" style="margin-top: 15px">
    @using (Html.BeginForm("Data_Upload", "Train", FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-inline" }))
    {
        <div class="form-group">
            <label for="importposts">Bulk Import:</label>
            <input type="file" name="file" class="form-control" id="importposts" />
            <label for="mainEntity">Main Tag:</label>
            <!-- <input type="text" name="mainEntity" class="form-control" id="mainEntity" /> -->
            @* <div class="dropdown div-inline">
                    <button class="btn btn-primary btn-sm dropdown-toggle" type="button" data-toggle="dropdown">
                        Select Theme
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        @foreach(var xtrctTheme in ViewBag.XtrctThemes)
                        {
                        <li class="@xtrctTheme.CurrentActive"><a href="#">@xtrctTheme.ThemeName</a></li>
                        }
                    </ul>
                </div> *@
            @Html.DropDownList("mainEntity", (IEnumerable<SelectListItem>)ViewBag.XtrctThemesPlain, /*"-- Select Contact --"*/null, new { @class = "form-control" })
        </div>
        <button class="btn btn-success btn-md" type="submit" id="import_posts">
            Import Posts
        </button>
        <div class="alert alert-warning alert-dismissable div-inline margin-bottom-0" style="@(showAlertWarning != true ? "display: none;" : "")">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            <strong>Warning!</strong> @msgAlert
        </div>
        <div class="alert alert-success alert-dismissable div-inline margin-bottom-0" style="@(showAlertSuccess != true ? "display: none;" : "")">
            <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
            <strong>Success!</strong> @msgAlert
        </div>
    }
</div>

<!-- Place where you will insert your partial -->
<div id="partialPlaceHolder" style="display:inline;"> </div>